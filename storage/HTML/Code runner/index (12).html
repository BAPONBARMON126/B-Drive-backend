<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Code Runner</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{
  box-sizing:border-box;
  -webkit-tap-highlight-color: transparent;
}

/* ===== PAGE ===== */
html, body{
  margin:0;
  padding:0;
  height:100dvh;
  background:#000;
  font-family:Consolas, monospace;
  display:flex;
  flex-direction:column;
}

/* ===== TOOLBAR ===== */
.toolbar{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:6px;
  padding:8px;
  background:#000;
  border-bottom:1px solid #00ff7f33;
}

/* ===== SAME SIZE BUTTONS ===== */
.ui-btn,
.find-input{
  width:72px;
  height:36px;
  background:#00ff7f;
  color:#000;
  border:none;
  border-radius:10px;
  font-size:13px;
  font-weight:800;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* find */
.find-input{
  outline:none;
  text-align:center;
}

.find-input::placeholder{
  color:#000;
  opacity:.9;
}

/* ===== EDITOR ===== */
.editor-wrapper{
  flex:1;
  min-height:0;
}

#editor{
  width:100%;
  height:100%;
  user-select:text !important;
  -webkit-user-select:text !important;
}

/* ===== RUN BAR ===== */
.run-bar{
  position:sticky;
  bottom:0;
  padding:6px;
  background:#000;
  border-top:1px solid #00ff7f33;
}

.run-bar button{
  width:100%;
  height:38px;
  background:#00ff7f;
  color:#000;
  border:none;
  border-radius:12px;
  font-size:14px;
  font-weight:900;
}

/* ===== OUTPUT ===== */
#runner{
  position:fixed;
  inset:0;
  background:#000;
  display:none;
  flex-direction:column;
  z-index:9999;
}

.runner-bar{
  display:flex;
  justify-content:center;
  gap:6px;
  padding:8px;
  border-bottom:1px solid #00ff7f33;
}

.runner-bar .ui-btn{
  width:72px;
}

/* iframe */
iframe{
  flex:1;
  border:none;
  background:#fff;
}

/* ===== COPY POPUP ===== */
#copyToast{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#00000088;
  opacity:0;
  pointer-events:none;
  transition:.25s ease;
  z-index:10000;
}

#copyToast span{
  background:#00ff7f;
  color:#000;
  padding:16px 28px;
  border-radius:16px;
  font-weight:900;
  font-size:18px;
}

#copyToast.show{
  opacity:1;
}
</style>

<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.js"></script>
</head>

<body>

<!-- ===== TOOLBAR ===== -->
<div class="toolbar">
  <button class="ui-btn" onclick="pasteCode()">Paste</button>
  <button class="ui-btn" onclick="clearCode()">Clear</button>
  <button class="ui-btn" onclick="copyAllCode()">Copy</button>
  <button class="ui-btn" onclick="undoCode()">Undo</button>
  <button class="ui-btn" onclick="redoCode()">Redo</button>

  <!-- FIND -->
  <input
    class="find-input"
    id="findBox"
    placeholder="ðŸ”"
    oninput="findText(this.value)"
  >
</div>

<!-- ===== EDITOR ===== -->
<div class="editor-wrapper">
  <div id="editor"></div>
</div>

<!-- ===== RUN ===== -->
<div class="run-bar">
  <button onclick="runCode()">Run Code</button>
</div>

<!-- ===== OUTPUT ===== -->
<div id="runner">
  <div class="runner-bar">
    <button class="ui-btn" onclick="refreshRun()">Refresh</button>
    <button class="ui-btn" onclick="closeRun()">Close</button>
  </div>
  <iframe id="output"></iframe>
</div>

<!-- ===== COPY POPUP ===== -->
<div id="copyToast">
  <span>Copy Successfully</span>
</div>

<script>
let editor;

/* ===== MONACO ===== */
require.config({
  paths:{vs:'https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs'}
});

require(['vs/editor/editor.main'], function(){
  editor = monaco.editor.create(document.getElementById('editor'), {
    value:`<!DOCTYPE html>
<html>
<body>
<h1>Hello World</h1>
</body>
</html>`,
    language:'html',
    theme:'vs-dark',
    automaticLayout:true,
    minimap:{enabled:false},
    autoFocus:false
  });

  setTimeout(()=>editor.blur(),0);
});

/* ===== ACTIONS ===== */
async function pasteCode(){
  const t = await navigator.clipboard.readText();
  editor.setValue(editor.getValue() + t);
}

function clearCode(){
  editor.setValue('');
}

function copyAllCode(){
  navigator.clipboard.writeText(editor.getValue());
  const t=document.getElementById('copyToast');
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),1000);
}

function undoCode(){
  editor.trigger('keyboard','undo',null);
}

function redoCode(){
  editor.trigger('keyboard','redo',null);
}

function findText(q){
  if(!q) return;
  editor.trigger('keyboard','actions.find',{searchString:q});
}

/* âœ… FIXED RUN */
function runCode(){
  const iframe = document.getElementById('output');
  iframe.srcdoc = editor.getValue();
  document.getElementById('runner').style.display = 'flex';
}

function refreshRun(){
  const iframe = document.getElementById('output');
  iframe.srcdoc = iframe.srcdoc;
}

function closeRun(){
  document.getElementById('runner').style.display='none';
}
</script>

</body>
</html>
